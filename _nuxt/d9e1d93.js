(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{870:function(t,e,n){var map={"./af":734,"./af.js":734,"./ar":735,"./ar-dz":736,"./ar-dz.js":736,"./ar-kw":737,"./ar-kw.js":737,"./ar-ly":738,"./ar-ly.js":738,"./ar-ma":739,"./ar-ma.js":739,"./ar-sa":740,"./ar-sa.js":740,"./ar-tn":741,"./ar-tn.js":741,"./ar.js":735,"./az":742,"./az.js":742,"./be":743,"./be.js":743,"./bg":744,"./bg.js":744,"./bm":745,"./bm.js":745,"./bn":746,"./bn-bd":747,"./bn-bd.js":747,"./bn.js":746,"./bo":748,"./bo.js":748,"./br":749,"./br.js":749,"./bs":750,"./bs.js":750,"./ca":751,"./ca.js":751,"./cs":752,"./cs.js":752,"./cv":753,"./cv.js":753,"./cy":754,"./cy.js":754,"./da":755,"./da.js":755,"./de":756,"./de-at":757,"./de-at.js":757,"./de-ch":758,"./de-ch.js":758,"./de.js":756,"./dv":759,"./dv.js":759,"./el":760,"./el.js":760,"./en-au":761,"./en-au.js":761,"./en-ca":762,"./en-ca.js":762,"./en-gb":763,"./en-gb.js":763,"./en-ie":764,"./en-ie.js":764,"./en-il":765,"./en-il.js":765,"./en-in":766,"./en-in.js":766,"./en-nz":767,"./en-nz.js":767,"./en-sg":768,"./en-sg.js":768,"./eo":769,"./eo.js":769,"./es":770,"./es-do":771,"./es-do.js":771,"./es-mx":772,"./es-mx.js":772,"./es-us":773,"./es-us.js":773,"./es.js":770,"./et":774,"./et.js":774,"./eu":775,"./eu.js":775,"./fa":776,"./fa.js":776,"./fi":777,"./fi.js":777,"./fil":778,"./fil.js":778,"./fo":779,"./fo.js":779,"./fr":780,"./fr-ca":781,"./fr-ca.js":781,"./fr-ch":782,"./fr-ch.js":782,"./fr.js":780,"./fy":783,"./fy.js":783,"./ga":784,"./ga.js":784,"./gd":785,"./gd.js":785,"./gl":786,"./gl.js":786,"./gom-deva":787,"./gom-deva.js":787,"./gom-latn":788,"./gom-latn.js":788,"./gu":789,"./gu.js":789,"./he":790,"./he.js":790,"./hi":791,"./hi.js":791,"./hr":792,"./hr.js":792,"./hu":793,"./hu.js":793,"./hy-am":794,"./hy-am.js":794,"./id":795,"./id.js":795,"./is":796,"./is.js":796,"./it":797,"./it-ch":798,"./it-ch.js":798,"./it.js":797,"./ja":799,"./ja.js":799,"./jv":800,"./jv.js":800,"./ka":801,"./ka.js":801,"./kk":802,"./kk.js":802,"./km":803,"./km.js":803,"./kn":804,"./kn.js":804,"./ko":805,"./ko.js":805,"./ku":806,"./ku.js":806,"./ky":807,"./ky.js":807,"./lb":808,"./lb.js":808,"./lo":809,"./lo.js":809,"./lt":810,"./lt.js":810,"./lv":811,"./lv.js":811,"./me":812,"./me.js":812,"./mi":813,"./mi.js":813,"./mk":814,"./mk.js":814,"./ml":815,"./ml.js":815,"./mn":816,"./mn.js":816,"./mr":817,"./mr.js":817,"./ms":818,"./ms-my":819,"./ms-my.js":819,"./ms.js":818,"./mt":820,"./mt.js":820,"./my":821,"./my.js":821,"./nb":822,"./nb.js":822,"./ne":823,"./ne.js":823,"./nl":824,"./nl-be":825,"./nl-be.js":825,"./nl.js":824,"./nn":826,"./nn.js":826,"./oc-lnc":827,"./oc-lnc.js":827,"./pa-in":828,"./pa-in.js":828,"./pl":829,"./pl.js":829,"./pt":830,"./pt-br":831,"./pt-br.js":831,"./pt.js":830,"./ro":832,"./ro.js":832,"./ru":833,"./ru.js":833,"./sd":834,"./sd.js":834,"./se":835,"./se.js":835,"./si":836,"./si.js":836,"./sk":837,"./sk.js":837,"./sl":838,"./sl.js":838,"./sq":839,"./sq.js":839,"./sr":840,"./sr-cyrl":841,"./sr-cyrl.js":841,"./sr.js":840,"./ss":842,"./ss.js":842,"./sv":843,"./sv.js":843,"./sw":844,"./sw.js":844,"./ta":845,"./ta.js":845,"./te":846,"./te.js":846,"./tet":847,"./tet.js":847,"./tg":848,"./tg.js":848,"./th":849,"./th.js":849,"./tk":850,"./tk.js":850,"./tl-ph":851,"./tl-ph.js":851,"./tlh":852,"./tlh.js":852,"./tr":853,"./tr.js":853,"./tzl":854,"./tzl.js":854,"./tzm":855,"./tzm-latn":856,"./tzm-latn.js":856,"./tzm.js":855,"./ug-cn":857,"./ug-cn.js":857,"./uk":858,"./uk.js":858,"./ur":859,"./ur.js":859,"./uz":860,"./uz-latn":861,"./uz-latn.js":861,"./uz.js":860,"./vi":862,"./vi.js":862,"./x-pseudo":863,"./x-pseudo.js":863,"./yo":864,"./yo.js":864,"./zh-cn":865,"./zh-cn.js":865,"./zh-hk":866,"./zh-hk.js":866,"./zh-mo":867,"./zh-mo.js":867,"./zh-tw":868,"./zh-tw.js":868};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=o,t.exports=r,r.id=870},872:function(t,e,n){var content=n(890);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(45).default)("4e2fc36e",content,!0,{sourceMap:!1})},873:function(t,e,n){var content=n(892);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(45).default)("1173577a",content,!0,{sourceMap:!1})},884:function(t,e,n){"use strict";n.r(e),n.d(e,"CommentItemInfo",(function(){return d}));var r=n(28),o=n(2),c=n(733),l=n.n(c),d=function t(){Object(r.a)(this,t),this.id="",this.user=void 0,this.parent=void 0,this.content="",this.time=0,this.subs=[],this.obj=void 0},m=o.default.extend({props:{item:{type:Object,default:new d,required:!0},sub:{type:Boolean,default:!1}},data:function(){return{nickname:"",avatar:""}},mounted:function(){this.item.user&&(this.nickname=this.item.user.get("nickname"),this.avatar=this.item.user.get("avatar"))},methods:{getDateString:function(time){return time?l()(time).format("YYYY-MM-DD HH:mm:ss"):"Invalid time"}}}),f=n(53),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"my-2"},[n("b-row",[n("b-col",{attrs:{cols:"auto"}},[n("b-avatar",{attrs:{src:t.avatar,size:t.sub?"2em":"3em"}})],1),t._v(" "),n("b-col",{staticClass:"pl-2"},[n("b-row",{staticClass:"pb-1"},[n("b-col",[n("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.nickname))]),t._v("    \n          "),n("span",{staticClass:"text-secondary"},[t._v(t._s(t.getDateString(t.item.time)))])])],1),t._v(" "),n("b-row",[n("b-col",[t._v("\n          "+t._s(t.item.content)+"\n        ")])],1),t._v(" "),n("b-row",{staticClass:"sub"},[n("b-col",[t._t("default")],2)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},889:function(t,e,n){"use strict";n(872)},890:function(t,e,n){(e=n(44)(!1)).push([t.i,".voice-progress[data-v-21696792]{display:block;position:absolute;width:100%;height:100%;left:0;top:0;z-index:-1}.voiceCard .button-trans[data-v-21696792]{opacity:.9;color:#000}.badge-corner[data-v-21696792]{position:absolute;right:-.5em;top:-.5em;background-color:#4d5b6d!important;color:#fff!important}",""]),t.exports=e},891:function(t,e,n){"use strict";n(873)},892:function(t,e,n){(e=n(44)(!1)).push([t.i,".comments[data-v-46c385c0]{background-color:#fff;padding:1em;margin:1em auto;border-radius:1rem;box-shadow:.1rem .1rem .5rem .1rem grey}",""]),t.exports=e},917:function(t,e,n){"use strict";n.r(e);n(35);var r=n(2),o=n(66),c=n.n(o),l=r.default.extend({props:{voices:{type:Array,default:function(){return[]}}},data:function(){return{playingName:"",playingLoaded:0,playingPlayed:0,voiceClicks:[],timeCounter:void 0}},watch:{},mounted:function(){},methods:{playAudio:function(t){var e=this;try{clearInterval(this.timeCounter),this.timeCounter=void 0,this.playingLoaded=0,this.playingPlayed=0,this.playingName=t.filename;var audio=this.$refs.audio;audio.src=t.src,audio.load(),this.timeCounter=setInterval((function(){e.progressSet(e.$refs.audio)}),100),this.incClick(t)}catch(t){this.$sentry.captureException(t)}},progress:function(t){try{var audio=t.target;this.progressSet(audio)}catch(t){this.$sentry.captureException(t)}},play:function(t){t.target.play()},timeupdate:function(t){var audio=t.target;this.progressSet(audio)},progressSet:function(audio){var t=audio.buffered.length>0?audio.buffered.end(0):0;this.playingLoaded=100*t/audio.duration,this.playingPlayed=100*audio.currentTime/audio.duration},ended:function(){this.playingLoaded=100,this.playingPlayed=100,this.playingName="",this.playingLoaded=0,this.playingPlayed=0,clearInterval(this.timeCounter),this.timeCounter=void 0},showProgress:function(t){return this.playingName===t.filename},incClick:function(t){var e=this,n=c.a.parseJSON(t.obj);n.increment("click_pv"),n.save(null,{fetchWhenSave:!0}).then((function(a){t.clickPV=a.get("click_pv")})).catch((function(t){e.$sentry.captureException(t)}))}}}),d=(n(889),n(53)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"voiceCard"},[t._l(t.voices,(function(a){return n("b-card",{key:a.name,attrs:{header:a.name}},t._l(a.voices,(function(e){return n("b-button",{key:e.filename,staticClass:"text-nowrap m-1 position-relative",class:t.showProgress(e)?"button-trans":"",on:{click:function(n){return t.playAudio(e)}}},[t.showProgress(e)?n("div",{staticClass:"voice-progress"},[n("b-progress",{attrs:{max:"100",height:"100%"}},[n("b-progress-bar",{attrs:{value:t.playingPlayed,variant:"primary",striped:"",animated:""}}),t._v(" "),n("b-progress-bar",{attrs:{value:t.playingLoaded-t.playingPlayed,variant:"secondary",striped:"",animated:""}})],1)],1):t._e(),t._v(" "),n("div",[n("span",[t._v(t._s(e.text))]),t._v(" "),n("b-badge",{staticClass:"badge-corner",attrs:{variant:"light",pill:""}},[t._v("\n          "+t._s(e.clickPV)+"\n        ")])],1)])})),1)})),t._v(" "),n("audio",{ref:"audio",attrs:{preload:"auto"},on:{progress:t.progress,canplaythrough:t.play,timeupdate:t.timeupdate,ended:t.ended,loadeddata:t.progress,loadedmetadata:t.progress}})],2)}),[],!1,null,"21696792",null);e.default=component.exports},918:function(t,e,n){"use strict";n.r(e);n(93),n(13),n(14);var r=n(2),o=n(66),c=n.n(o),l=n(884),d=r.default.extend({props:{pageId:{type:String,default:""}},data:function(){return{comments:[]}},mounted:function(){this.refresh()},methods:{refresh:function(){var t=this,e=new c.a.Query("Comments");e.equalTo("parent",null),e.include("user"),e.find().then((function(e){t.comments=[],e.forEach((function(e){var n,r=new l.CommentItemInfo;r.id=null!==(n=e.id)&&void 0!==n?n:"",r.user=e.get("user"),r.parent=e.get("parent"),r.content=e.get("content"),r.time=e.get("time"),r.obj=e,t.comments.push(r);var o=new c.a.Query("Comments");o.equalTo("parent",e),o.include("user"),o.find().then((function(t){t.forEach((function(sub){var t,s=new l.CommentItemInfo;s.id=null!==(t=sub.id)&&void 0!==t?t:"",s.user=sub.get("user"),s.parent=sub.get("parent"),s.content=sub.get("content"),s.time=sub.get("time"),s.obj=sub,r.subs.push(s)}))}))}))}))}}}),m=(n(891),n(53)),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"comments"},[n("CommentInput",{attrs:{"page-id":t.pageId},on:{refresh:t.refresh}}),t._v(" "),t._l(t.comments,(function(e){return n("CommentItem",{key:e.id,attrs:{item:e}},t._l(e.subs,(function(sub){return n("CommentItem",{key:sub.id,attrs:{item:sub,sub:""}})})),1)}))],2)}),[],!1,null,"46c385c0",null);e.default=component.exports;installComponents(component,{CommentInput:n(925).default,CommentItem:n(884).default})},925:function(t,e,n){"use strict";n.r(e);n(35);var r=n(2),o=n(66),c=n.n(o),l=n(733),d=n.n(l),m=r.default.extend({props:{pageId:{type:String,default:""},parent:{type:Object,default:void 0}},data:function(){return{content:"",canSend:!0}},mounted:function(){var t=this;setInterval((function(){c.a.User.current()||(t.canSend=!1)}),200)},methods:{sendComment:function(){var t=this,e=c.a.User.current();if(e){var n=new c.a.Object("Comments");n.set("pageId",this.pageId),n.set("content",this.content),n.set("user",e),n.set("time",d.a.now()),this.parent&&n.set("parent",this.parent),n.save().then((function(e){t.content="",t.$emit("refresh")}))}}}}),f=n(53),component=Object(f.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{staticClass:"py-3"},[n("b-form",[n("b-row",[n("b-col",[n("b-textarea",{attrs:{"no-resize":"",rows:"3",disabled:!t.canSend},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)],1),t._v(" "),n("b-row",{staticClass:"mt-3 text-right"},[n("b-col",[n("b-button",{attrs:{disabled:!t.canSend},on:{click:t.sendComment}},[t._v("\n          发送\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},930:function(t,e,n){"use strict";n.r(e);n(93),n(13),n(27),n(21),n(39),n(68),n(14),n(81),n(237),n(74);var r=n(26),o=n(2),c=n(66),l=n.n(c),d=o.default.extend({data:function(){return{audio:[]}},mounted:function(){var t=this;Promise.all([this.fetchAudios()]).catch((function(e){t.$sentry.captureException(e)}))},methods:{fetchAudios:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n="http://qiniu.amemachif.ioit.pub/audio/",r=new l.a.Query("Audio"),e.next=5,r.limit(1e3).descending("click_pv").find();case 5:e.sent.forEach((function(a){var g=t.audio.find((function(p){return p.name===a.get("group")})),e={filename:a.get("name")+".aac",src:new URL(a.get("name")+".aac",n).toString(),text:a.get("text"),clickPV:a.get("click_pv"),obj:a.toFullJSON()};g?g.voices.push(e):t.audio.push({name:a.get("group"),voices:[e]})})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t.$sentry.captureException(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()}}}),m=n(53),component=Object(m.a)(d,(function(){var t=this.$createElement,e=this._self._c||t;return e("b-container",{attrs:{fluid:""}},[e("VoiceCard",{attrs:{voices:this.audio}}),this._v(" "),e("Comment",{attrs:{"page-id":"/bar"}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{VoiceCard:n(917).default,Comment:n(918).default})}}]);
//# sourceMappingURL=d9e1d93.js.map